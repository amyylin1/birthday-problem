```{r}
#install.packages("readxl")
library(readxl)
```

# test:

## 1. extract 1 sheet

```{r}
# Assuming your Excel file has a sheet named "Sheet1" and the birthdays are in column A
birthdays_data <- read_excel( "Winnipeg_jets.xlsx", 
                              sheet = "Winnipeg Jetts", 
                              col_names = TRUE )
birthdays_data
```

## 2 extract all team names

```{r}
# Specify the path to your Excel file
excel_file <- "Winnipeg_jets.xlsx"

# Get the names of all sheets in the Excel file
all_sheets <- excel_sheets(excel_file)

# Loop through each sheet and print its name
for (sheet_name in all_sheets) {
  print(sheet_name)
  # Add your code here to perform tasks for each sheet
}

```

## 3. graph 1

```{r}
library(ggplot2)

# Read the Excel file
birthdays_data <- read_excel( "Winnipeg_jets.xlsx", 
                              sheet = 'Winnipeg Jetts', 
                              col_names = FALSE )

# Check the structure of the data frame
str( birthdays_data )

# extract the first column of the df
birthdays <- as.Date( birthdays_data$`...1`)
print(birthdays)

# extract date only
day_month <- format( birthdays, '%m-%d' )
#day_month

data <- data.frame( day_month )

      # Plot the data
p <- ggplot(data, aes(x = day_month)) +
  geom_bar(color = "black", fill = "lightblue") +
  labs(x = "Date (Month-Day)", y = "Frequency", title = paste("Distribution of Birthdays (Month-Day) -", sheet_name))

# Set axis labels, title, and scale
p + labs(x = "Date (Month-Day)", y = "Frequency", title = paste("Distribution of Birthdays (Month-Day) -", sheet_name)) +
  scale_x_discrete(labels = function(x) strwrap(x, width = 5)) +
  scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, by = 10)) +
  theme(axis.title.x = element_text(size = 12, margin = margin(t = 10)),
        axis.text.x = element_text(size = 6))  # Adjust the size here

            
```

## 4. extract all data

```{r}
# Loop through each sheet
file_path <- "Winnipeg_jets.xlsx"

# Get the names of all sheets in the Excel file
all_sheets <- excel_sheets(excel_file)

# Loop through each sheet and print its name
for (sheet_name in all_sheets) {
  print(sheet_name)
  # Add your code here to perform tasks for each sheet
}

# Get the names of all sheets in the Excel file
all_sheets <- excel_sheets(excel_file)
print(all_sheets)

for (sheet_name in all_sheets) {
    # Load data from the current sheet
      sheet_data <- read_excel(file_path, sheet = sheet_name, col_names = FALSE)
    
      print(sheet_data)
    #str( birthdays_data )

# extract the first column of the df
      birthdays <- as.Date( birthdays_data$`...1`)
      
# extract date only
      day_month <- format( birthdays, '%m-%d' )

}

```

```{r}
library(ggplot2)
library(readxl)

file_path <- "Winnipeg_jets.xlsx"

# Initialize a variable to store the maximum frequency
max_frequency <- 0

for (sheet_name in all_sheets) {
      
    # Load data from the current sheet
    sheet_data <- read_excel(file_path, sheet = sheet_name, col_names = FALSE)
    
    # Extract the first column of the df
    birthdays <- as.Date(sheet_data$`...1`)
      
    # Extract date only
    day_month <- format(birthdays, '%m-%d')
    data <- data.frame(day_month)
    
    # Count the frequency of each date
    freq_table <- table(day_month)
    
    # Update the maximum frequency if needed
    max_frequency <- max(max_frequency, max(freq_table))
}

# Iterate over sheets again to create plots with the same y-axis scale
for (sheet_name in all_sheets) {
      
    # Load data from the current sheet
    sheet_data <- read_excel(file_path, sheet = sheet_name, col_names = FALSE)
    
    # Extract the first column of the df
    birthdays <- as.Date(sheet_data$`...1`)
      
    # Extract date only
    day_month <- format(birthdays, '%m-%d')
    data <- data.frame(day_month)
    
    # Create the plot
    p <- ggplot(data, aes(x = day_month)) +
            geom_bar(color = "black", fill = "lightblue") +
            labs(x = "Date (Month-Day)", 
                 y = "Frequency", 
                 title = paste("Distribution of Birthdays (Month-Day) -", sheet_name)) +
            scale_y_continuous(limits = c(0, max_frequency)) +  # Set y-axis limits
            theme(axis.title.x = element_text(size = 12),
                  axis.text.x = element_text(size = 5),  # Set x-axis tick label size
                  axis.title.y = element_text(size = 12),
                  axis.text.y = element_text(size = 10))

    print(p)
}

```

```{r}
library(ggplot2)
library(readxl)

# Specify the path to your Excel file
excel_file <- "Winnipeg_jets.xlsx"

# Get the names of all sheets in the Excel file
all_sheets <- excel_sheets(excel_file)

# Create a folder named "plots" if it doesn't exist
if (!file.exists("plots")) {
  dir.create("plots")
}

# Initialize a variable to store the maximum frequency
max_frequency <- 0

# Iterate over sheets to create plots
for (sheet_name in all_sheets) {
  
  # Load data from the current sheet
  sheet_data <- read_excel(excel_file, sheet = sheet_name, col_names = FALSE)
  
  # Extract the first column of the df
  birthdays <- as.Date(sheet_data$`...1`)
  
  # Extract date only
  day_month <- format(birthdays, '%m-%d')
  data <- data.frame(day_month)
  
  # Count the frequency of each date
  freq_table <- table(day_month)
  
  # Update the maximum frequency if needed
  max_frequency <- max(max_frequency, max(freq_table))
  
  # Create the plot
  p <- ggplot(data, aes(x = day_month)) +
    geom_bar(color = "black", fill = "lightblue") +
    labs(x = "Date (Month-Day)", 
         y = "Frequency", 
         title = paste("Distribution of Birthdays (Month-Day) -", sheet_name)) +
    scale_y_continuous(limits = c(0, max_frequency)) +  # Set y-axis limits
    theme(axis.title.x = element_text(size = 12),
          axis.text.x = element_text(size = 8),  # Set x-axis tick label size
          axis.title.y = element_text(size = 12),
          axis.text.y = element_text(size = 10))
  
  # Save the plot as an image file in the "plots" folder
  ggsave(filename = paste0("plots/", sheet_name, "_plot.png"), plot = p, width = 8, height = 6, units = "in")
}

```

# 5. graph all

```{r}
library(ggplot2)
library(readxl)

# Specify the path to your Excel file
excel_file <- "Winnipeg_jets.xlsx"

# Get the names of all sheets in the Excel file
all_sheets <- excel_sheets(excel_file)

# Initialize a variable to store all data
all_data <- data.frame()

# Iterate over sheets to extract data
for (sheet_name in all_sheets) {
  
  # Load data from the current sheet
  sheet_data <- read_excel(excel_file, sheet = sheet_name, col_names = FALSE)
  
  # Combine data from all sheets
  all_data <- rbind(all_data, sheet_data)
}

# Extract the first column of the combined data frame
birthdays <- as.Date(all_data$`...1`)

# Extract date only
day_month <- format(birthdays, '%m-%d')

# Count the frequency of each date
freq_table <- table(day_month)

# Get the maximum frequency
max_frequency <- max(freq_table)

# Create the plot
p <- ggplot(data.frame(day_month), aes(x = day_month)) +
  geom_bar(color = "black", fill = "lightblue") +
  labs(x = "Date (Month-Day)", 
       y = "Frequency", 
       title = "Distribution of Birthdays (Month-Day) - All teams") +
  scale_y_continuous(limits = c(0, max_frequency)) +  # Set y-axis limits
  theme(axis.title.x = element_text(size = 12),
        axis.text.x = element_text(size = 1),  # Set x-axis tick label size
        axis.title.y = element_text(size = 12),
        axis.text.y = element_text(size = 10))

ggsave(filename = paste0('plots/', "all.png"), plot = p, width = 8, height = 6, units = "in")

# Print the plot
print(p)

```

# 6. freq. > = 2 

```{r}
library(ggplot2)
library(readxl)

# Specify the path to your Excel file
excel_file <- "Winnipeg_jets.xlsx"

# Get the names of all sheets in the Excel file
all_sheets <- excel_sheets(excel_file)

# Initialize a variable to store all data
all_data <- data.frame()

# Iterate over sheets to extract data
for (sheet_name in all_sheets) {
  
  # Load data from the current sheet
  sheet_data <- read_excel(excel_file, sheet = sheet_name, col_names = FALSE)
  
  # Combine data from all sheets
  all_data <- rbind(all_data, sheet_data)
}

# Extract the first column of the combined data frame
birthdays <- as.Date(all_data$`...1`)

# Extract date only
day_month <- format(birthdays, '%m-%d')

# Count the frequency of each date
freq_table <- table(day_month)

# Filter the frequency table to include only dates that repeat 2 or more times
freq_table_filtered <- freq_table[freq_table >= 2]

# Get the maximum frequency
max_frequency <- max(freq_table_filtered)

# Create a data frame for the filtered dates
filtered_data <- data.frame(day_month = names(freq_table_filtered), freq = as.numeric(freq_table_filtered))

# Create the plot
two <- ggplot(filtered_data, aes(x = day_month, y = freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue") +
  labs(x = "Date (Month-Day)", 
       y = "Frequency", 
       title = "Distribution of Birthdays (Month-Day) - Repeated 2 or More Times") +
  theme(axis.title.x = element_text(size = 12),
        axis.text.x = element_text(size = 2 ),  # Set x-axis tick label size
        axis.title.y = element_text(size = 12),
        axis.text.y = element_text(size = 10))

ggsave(filename = paste0("plots/",  "2.png"), plot = p, width = 8, height = 6, units = "in")

# Print the plot
print(two)



```

# 7. freq. >= 3

```{r}
# Filter the frequency table to include only dates that repeat 2 or more times
freq_table_filtered <- freq_table[freq_table >= 3]

# Get the maximum frequency
max_frequency <- max(freq_table_filtered)

# Create a data frame for the filtered dates
filtered_data <- data.frame(day_month = names(freq_table_filtered), freq = as.numeric(freq_table_filtered))

# Create the plot
three <- ggplot(filtered_data, aes(x = day_month, y = freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue") +
  labs(x = "Date (Month-Day)", 
       y = "Frequency", 
       title = "Distribution of Birthdays (Month-Day) - Repeated 2 or More Times") +
  theme(axis.title.x = element_text(size = 12),
        axis.text.x = element_text(size = 4 ),  # Set x-axis tick label size
        axis.title.y = element_text(size = 12),
        axis.text.y = element_text(size = 10))

ggsave(filename = paste0("plots/",  "3.png"), plot = p, width = 8, height = 6, units = "in")

# Print the plot
print(three)
```





